# udev rules for automatic CD/DVD ripping
# Place this file in /etc/udev/rules.d/

# Primary rule: Trigger on optical disc media change
SUBSYSTEM=="block", KERNEL=="sr[0-9]*", ENV{ID_CDROM}=="1", ACTION=="change", ENV{DISK_MEDIA_CHANGE}=="1", RUN+="/opt/auto-ripper/trigger-rip.sh %k"

# Alternative rule for broader compatibility (some drives don't set DISK_MEDIA_CHANGE)
SUBSYSTEM=="block", KERNEL=="sr[0-9]*", ACTION=="change", ATTR{removable}=="1", RUN+="/opt/auto-ripper/trigger-rip.sh %k"

# Additional rule for USB optical drives
SUBSYSTEM=="block", ACTION=="add", KERNEL=="sr[0-9]*", ATTRS{removable}=="1", RUN+="/opt/auto-ripper/check-disc.sh %k"