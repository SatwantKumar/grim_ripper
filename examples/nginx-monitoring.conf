# Nginx configuration for web-based monitoring
# Place this in /etc/nginx/sites-available/auto-ripper-monitor

server {
    listen 80;
    server_name pi-ripper.local;
    
    # Basic authentication
    auth_basic "Auto-Ripper Monitor";
    auth_basic_user_file /etc/nginx/.htpasswd;
    
    # Log files viewer
    location /logs {
        alias /var/log/auto-ripper/;
        autoindex on;
        autoindex_exact_size off;
        autoindex_localtime on;
        
        # Only allow text files
        location ~ \.(log|txt)$ {
            add_header Content-Type text/plain;
        }
    }
    
    # Configuration viewer
    location /config {
        alias /opt/auto-ripper/config.json;
        add_header Content-Type application/json;
    }
    
    # System status
    location /status {
        return 200 '{"status": "active", "timestamp": "$time_iso8601"}';
        add_header Content-Type application/json;
    }
    
    # Music output directory
    location /music {
        alias /mnt/MUSIC/;
        autoindex on;
        autoindex_exact_size off;
        autoindex_localtime on;
    }
    
    # Default page
    location / {
        return 301 /status;
    }
}

# Setup instructions:
# 1. sudo apt install nginx
# 2. sudo cp this file to /etc/nginx/sites-available/auto-ripper-monitor
# 3. sudo ln -s /etc/nginx/sites-available/auto-ripper-monitor /etc/nginx/sites-enabled/
# 4. sudo htpasswd -c /etc/nginx/.htpasswd pi
# 5. sudo systemctl reload nginx
